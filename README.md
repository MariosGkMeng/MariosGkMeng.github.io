# simulation-dashboard

## Motivation
           

The main goals of this long-awaited tool are:

- To introduce human factors and aesthetics to simulation studies with platforms that do not come with lean and flexible post-processors in order to minimize errors, eye strain and gasps of tiredness associated with assessing, understanding and writing code for extended periods of time.
- To automate tasks related to simulation studies and simulation results organization and comparison.

It has been years since I wished to be able to

-  effortlessly navigate through numerous simulation results
	-  without having to search them with traditional and inefficient methods (such as folder searching, file searching, etc.)
	- without the need to manually write simulation logs by noting parameter variations by hand. For instance, say you need to investigate effects of parameters you set in a simulation. Imagine having to write “parameter1: 0 --> 1” by hand for every simulation and then having to write assessment on effect of that parameter change by hand every time!

- Minimize the strain in my eyes that is generated by going through code all day! No matter how much you like to code, a combination of asimplistic GUI with smart automations and coding only when necessary is so much more human-oriented than a command line (sorry command line fans).

Of course, if you happen to be working on an already developed software that offers an efficient and pleasing post-processor, you do not need this tool right now. But often you will need to work on projects in which you’ll need to develop scripts (or use someone else’s) that perform the calculations.

Why excel and VBA?

*“What?? VBA?? How are you still using this old-fashioned, limited programming language in 2021??”*

Ok, before you report me to the Gods of programming, don’t forget that as a user you most probably won’t need to open a single VBA script in the tool.

Since many years I needed to enrich my excel automation skills for a few projects until it became a frequent “weapon of choice”. I was astounded by the vastness of possibilities excel can offer, while making it easy to check large chunks of numbers in a clean way.

For me, excel IS, in a way, a programming language. It is not tailored to computationally intensive tasks and this is the reason that I opt to use it only for organizing files, work and make visualizations. Especially regarding visualizations, it is easy to connect simple function results with different colors and styles in excel, as well as with icons. For a person who knows how to program in VBA, excel can be transformed into an optimal user-specific GUI.

If you have never used excel in that way and are skeptical, trust me, it is worth the small effort to get yourself familiarized with some of its capabilities, at least for the scope of this tool. I tried to keep the need to modify VBA scripts to a minimum. You are, however, required to have knowledge on how to use excel without VBA.

In addition, I believe that one should prefer this tool from other means of creating apps, because coding in VBA and writing functions in excel is much easier than building web-based apps, or apps on languages such as C++ and Java. After all, this tool is meant to be used by simulation engineers, researchers and generally analyzers, not strictly by developers. It is, therefore, easier to manipulate code in an excel-based tool and tailor it to your needs, than a web-based Java app.

Last but not least, given the fact that VBA is a very old and widely used language, it is so easy to google-search solutions to problems and find more than one suggestion in various websites. The VBA community is very large and eager to provide help.

  

---

[[1]](#_ftnref1) There is a possibility to integrate Python, Javascript and C# to excel. It is in my TODO list for further development for this tool to migrate VBA to Python scripting.

           

## Modes of operation

There are two possible operation modes for which this tool works.

· **“Mode 1”** is the mode in which the tool connects to a simulator that is capable of text-parsing (usually a scripting environment that engineers use, like MATLAB, or Python). Check Figure below.
![[Pasted image 20210612161701.png|350]]


· “**Mode 2**” the one in which the simulator is unable to parse text files. That is usually a closed-source software that comes with a GUI. Check Figure below.
![[Pasted image 20210612161755.png|350]]

           

# Start from blank project

## Control room

In the “control room” you can:

- Define new parameters and change their values
- Add notes to parameters than only appear when you click on them
- Trigger a simulation
- Save a simulation’s results
- Stop a simulation

A control room that contains a few variables looks like the one in the provided example.

## Set project paths

1. Go to “project_paths” sheet. Set the following paths:
	1. *“print parameter file”:** This is the path where the parameter file is printed, ready to be parsed from your simulator (applicable for Mode 1)
	2.  **“write trigger text file”:** This is the path where the trigger file is printed, ready to be parsed from your simulator (applicable for Mode 1). More on trigger file in ???.
	3.  **“dropbox_folder_linking”:** This is the path where the simulator prints some user-wanted information (such as deviations from a mean variable, computation time, etc). This user wanted information is set in a script inside the simulator


## Create a new parameter

Type in the name of the **parameter** (in the same way that it will be read from your simulator). Once written, it is automatically generated in the vault. The corresponding value should be written next to the parameter (at its right). Check the example file for clarification.  ==IMPORTANT NOTE==: **Parameters should ONLY be written in odd columns (e.g. “A”, “C”, “E”, etc) and never before row 6!**

The simulator obtains the parameters in a proper form. Since so far the supported simulators are MATLAB and Python, a convenient and organized way to parse parameters is via struct variables and dictionaries correspondingly. If, for instance, you create a parameter titled “mass” and set a value of, say, “100”, then if your simulator is: 
       
- MATLAB, the parameter file will include a line: “d.mass = 100;”
- Python, the parameter file will include a line: “d[“mass”] = 100”

           

Where “d” is the struct or dictionary variable that carries the parameters. You can change the name of that struct variable in the “parameter_map” sheet, cell “A2”, or variable “struct_name”.


## Create a  parameter family

           

To enhance organization of your parameters, you can create parameter categories, or “families”. To do so, simply write “fam__familyName (optional_field_name)”.

- Why write “fam__” before the name?
	- So far, the program I developed understands parameter families that way
- What is “optional_field_name”?
	- The parameters are written in a struct (if simulator is MATLAB) or dictionary (if simulator is Python). If in your code you want to further categorize some parameters and make it easy to read, you can have something like: “d.deb.set_to_zero_when_inf”. The field “deb” can be referring to debugging related, on/off type of parameters. In that case, you write“fam__debugging (deb)”. If you do not want such a categorization, simply set the family like this: “fam__familyName ()”.


## View and create notes on parameters

- If you select a parameter cell, its notes automatically pop-up
- To add a note, click on the " ![[Pasted image 20210612163052.png|50]]" icon at the top of your current view
- To add a picture:
	- Copy the picture from your source
	- Paste it in the excel sheet (**NOTE**: **note view mode should be on**)
	- Press the ![[Pasted image 20210612163144.png|50]] icon (it basically attaches it to the group of notes that correspond to this parameter)

That way, you won’t need to navigate to other files in order to take notes on the effects of parameters. In addition, parameters can be linked to effects of specific metrics (say, “vehicle acceleration”, “fuel consumption” etc), and you can systematically document effects of parameters on metrics.

## Delete a parameter
           

Navigate to “**parameter_map**” sheet, column “C” (Picture ???). Simply go to the specific cell that contains that variable and press “Delete” from your keyboard. No need to insert anything in that list, since it is automatically generated. **NOTE: You can only delete one variable at a time. Also, you have to delete that variable from the “control_room”. This command deletes all the notes of that parameter****.**

![[Pasted image 20210612163341.png]]


## Run simulation in mode 1  

Find supported simulators (developed so far) in _Appendix_.
            

Steps (for MATLAB, more simulators to come in the future):

1. Run the “autorun.m” script in your MATLAB that reads the autorun file every (e.g., every 500ms). Leave that script running, **do not interrupt it**! You will have to edit this script first, to set which scripts/functions should run for each different event/trigger.

2. Go to the user interface --> "control_room" sheet and choose an action:

- Pressing “![[Pasted image 20210612163439.png]] ” runs a simulation with the specified parameters (excel writes to autorun file a trigger that is understood by the simulator parser, for instance: “RUN_SIM 1”. Simulator reads this and triggers the simulation process.

- Pressing “![[Pasted image 20210612163459.png]]” saves the simulation results. Press it only once the simulation is finished (more on that in section ???)
        
## Live Simulation dashboard – Check simulation data while simulation is running

            

Navigate to simulation dashboard by clicking the “![image](https://user-images.githubusercontent.com/61937432/121777995-7c42f900-cb9d-11eb-8ad4-35fc47c04408.png)” icon for the options to appear and then the “![image](https://user-images.githubusercontent.com/61937432/121777998-806f1680-cb9d-11eb-8fae-1533ec68fd37.png)” icon. As a default mode, some live results are parsed from a textfile when you click on a new cell.

In the example I provided for mode 1, MATLAB prints the computation time for each iteration and the word “PROBLEM” whenever a specific signal problem is encountered. In the live dashboard, the figure shows the CPU time of each iteration (blue curve) and whether a problem was encountered (red curve: 1 when “PROBLEM”).

To modify how the live dashboard works, you will have to change some cell equations in this sheet, so excel knowledge is required.

## Make your GUI more beautiful (to your standards of “beauty”)

Most people are not aware just how much you can achieve with excel. In this section, you will find some tips that help you make your dashboard easier to and more pleasurable to read.

Go to: View --> Appearance and deselect the boxes, so that you don’t have to always see those column letters and row numbers and equations that occupy your “eye space” when you don’t really need them. 
![image](https://user-images.githubusercontent.com/61937432/121777972-67fefc00-cb9d-11eb-9eb3-ad0c2b12a48e.png)

           

           

- Cell formatting --> Check “conditional formatting” on the internet 😉
	-  Format of parameter value bearing cells that contain formulas (so that you don’t just delete them).
- Copy the cell and paste as a connected icon. Then, each time the value and format of the cell changes, the same thing will happen to the icon.
- Flagging parameters with expressive icons
	- For parameters you consider critical for your results, you can have the GUI flag them with icons of your preference. Simply navigate to “parameter_map” sheet à “T5” cell and add the exact name of the parameter in the list (leave no empty cells between those parameters!). Once you go back to the control room, the icon will appear next to the parameter.
	- To change that icon, search for the icon named “potential_hazard__” in the “control_room” sheet, right click on it and select “change icon”.


## Parameter change and simulation history
           

For me, this is the most important feature of the tool. Its capabilities are:

- Rigorous and easy organization of parameter changes (e.g., if I change parameter “m” from 50 to 100 in the “control_room”, the tool will automatically print: <dd/mm/yyyy> **m:** **50** **-->** **100**)
- Gather notes of each simulation (write it below the parameter change) and effects of parameters to specific signals and/or indexes. See Picture ?? for an example.
![image](https://user-images.githubusercontent.com/61937432/121777960-59b0e000-cb9d-11eb-97a8-1fdc01f001f2.png)
